---
  name: playwright-automation
  on:
    schedule:
      - cron: 47 1 * * *
      - cron: 52 1 * * *
  jobs:
    build:
      name: Run end-to-end tests
      runs-on: ubuntu-latest
      strategy:
        matrix:
          batch:
            - 1
            - 2
      steps:
        - uses: actions/checkout@v3
          with:
            fetch-depth: 0
        - uses: actions/setup-node@v3
          with:
            node-version: "20"
        - name: install dependencies
          run: npm ci
        - name: install playwright
          run: npm install @playwright/test
        - name: run test environment
          env:
            test_env: test
          run: npx playwright test --project=chrome
        - uses: actions/upload-artifact@v2
          if: always()
          with:
            name: playwright-report
            path: playwright-report/
            retention-days: 30
        - name: Download zipped HTML report
          uses: actions/download-artifact@v2
          with:
            name: playwright-report
            path: playwright-report/
        - name: Notify on failure
          if: failure()
          run: >+
            curl -X POST -H 'Content-type: application/json' \
             --data '{"text":"<!here> Playwright tests has failed \"https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}\""}' \
             ${{ secrets.SLACK_WEBHOOK_URLS }}
             
  
  